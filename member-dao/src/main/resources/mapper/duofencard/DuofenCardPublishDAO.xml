<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gt.member.dao.duofencard.DuofenCardPublishDAO">

	<!-- 通用查询映射结果 -->
	<resultMap id="BaseResultMap" type="com.gt.duofencard.entity.DuofenCardPublish">
		<id column="publishId" property="publishId" />
		<result column="cardId" property="cardId" />
		<result column="number" property="number" />
		<result column="isBuy" property="isBuy" />
		<result column="buyMoney" property="buyMoney" />
		<result column="giftBuyMoney" property="giftBuyMoney" />
		<result column="isDiscount" property="isDiscount" />
		<result column="isFenbi" property="isFenbi" />
		<result column="isJifen" property="isJifen" />
		<result column="isReceiveNum" property="isReceiveNum" />
		<result column="forbidden" property="forbidden" />
		<result column="limitType" property="limitType" />
		<result column="limitNum" property="limitNum" />
		<result column="isRecommend" property="isRecommend" />
		<result column="jifen" property="jifen" />
		<result column="fenbi" property="fenbi" />
		<result column="flow" property="flow" />
		<result column="money" property="money" />
	</resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        publishId, cardId AS cardId,isDiscount,isFenbi,isJifen,forbidden, number, isBuy AS isBuy, buyMoney AS buyMoney, giftBuyMoney as giftBuyMoney,isReceiveNum AS isReceiveNum, limitType AS limitType, limitNum AS limitNum, isRecommend AS isRecommend, jifen, fenbi, flow, money
    </sql>

	<select id="findPublishDuofenCard" resultType="Map">
		select cp.publishId, cp.cardId AS cardId, cp.number, cp.isBuy AS isBuy, cp.buyMoney AS buyMoney,
		 cp.giftBuyMoney AS giftBuyMoney,
		 cp.isReceiveNum AS isReceiveNum, cp.limitType AS limitType, cp.limitNum AS limitNum,
		  cp.isRecommend AS isRecommend, cp.jifen, cp.fenbi, cp.flow, cp.money,c.* from t_duofen_card_publish cp
		 inner join t_duofen_card_new c on cp.cardId=c.id
		 where c.busId=#{busId} and c.useType=0 and  c.cardStatus=2
		 limit #{page},#{pageSize}
	</select>

	<select id="findByCardId" resultMap="BaseResultMap">
		select * from t_duofen_card_publish where cardId=#{cardId}
	</select>

	<select id="findPublishByCardId" resultType="Map">
		select cp.publishId, cp.cardId AS cardId, cp.number, cp.isBuy AS isBuy, cp.buyMoney AS buyMoney,
		cp.giftBuyMoney AS giftBuyMoney,
		cp.isReceiveNum AS isReceiveNum, cp.limitType AS limitType, cp.limitNum AS limitNum,
		cp.isRecommend AS isRecommend, cp.jifen, cp.fenbi, cp.flow, cp.money,c.* from t_duofen_card_publish cp
		inner join t_duofen_card_new c on cp.cardId=c.id
		where cp.cardId=#{cardId} and c.useType=0 and  c.cardStatus=2
	</select>

	<select id="findPublishDuofenCardByPublishId" resultType="Map">
	select cp.publishId, cp.cardId AS cardId, cp.number, cp.isBuy AS isBuy, cp.buyMoney AS buyMoney,
		 cp.giftBuyMoney AS giftBuyMoney,
		 cp.isReceiveNum AS isReceiveNum, cp.limitType AS limitType, cp.limitNum AS limitNum,
		  cp.isRecommend AS isRecommend, cp.jifen, cp.fenbi, cp.flow, cp.money,c.* from t_duofen_card_publish cp
		 inner join t_duofen_card_new c on cp.cardId=c.id
		 where cp.publishId=#{publishId}

	</select>

</mapper>
